"use strict";

$(document).ready(function() {
  // Inicializar editor de texto enriquecido (Quill)
  new Quill('[data-editor-target="editor"]', {
    placeholder: "Escribe tu propuesta aquí...", // Placeholder en español
    theme: "snow",
    modules: {
      toolbar: [
        ['bold', 'italic', 'underline'],
        ['link', 'blockquote', 'code-block'],
        [{ 'list': 'ordered'}, { 'list': 'bullet' }]
      ]
    }
  });

  // Configurar alerta de confirmación para enviar propuesta
  $('[data-alert-target="#alertMessage"]').on("click", function(event) {
    event.preventDefault();
    
    const swal = Swal.mixin({
      customClass: {
        confirmButton: "btn btn-success m-1",
        cancelButton: "btn btn-danger m-1"
      },
      buttonsStyling: false
    });
    
    swal.fire({
      title: "¿Estás seguro?",
      text: "¿Quieres enviar esta propuesta?",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Sí, ¡enviar!",
      cancelButtonText: "No, cancelar",
      reverseButtons: true,
      focusCancel: true, // Mejor UX para acciones importantes
      allowOutsideClick: false // Evitar cierre accidental
    }).then((result) => {
      if (result.isConfirmed) {
        swal.fire({
          title: "¡Enviado!",
          text: "La propuesta se envió correctamente.",
          icon: "success",
          timer: 2000,
          showConfirmButton: false
        }).then(() => {
          // Aquí iría la lógica para enviar la propuesta
          console.log("Propuesta enviada");
        });
      } else if (result.dismiss === Swal.DismissReason.cancel) {
        swal.fire({
          title: "Cancelado",
          text: "La propuesta no fue enviada.",
          icon: "error",
          timer: 2000,
          showConfirmButton: false
        });
      }
    });
  });

  // Inicializar selectores de fecha
  const fechaInicio = document.getElementById("startDate");
  const fechaVencimiento = document.getElementById("dueDate");
  
  new Datepicker(fechaInicio, {
    clearBtn: true,
    allowOneSidedRange: true,
    language: "es", // Configuración en español
    format: "dd/mm/yyyy" // Formato de fecha en español
  });

  new Datepicker(fechaVencimiento, {
    clearBtn: true,
    allowOneSidedRange: true,
    language: "es", // Configuración en español
    format: "dd/mm/yyyy" // Formato de fecha en español
  });
});