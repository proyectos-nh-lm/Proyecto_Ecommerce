"use strict";

$(document).ready(function() {
  // ======================================
  // 1. MANEJO DE SUBIDA DE ARCHIVOS
  // ======================================
  const initFileUpload = () => {
    const $fileInput = $(".file-upload");
    const $uploadButton = $(".upload-button");
    const $previewImage = $(".upload-pic");

    // Manejar cambio en el input de archivo
    $fileInput.on("change", function(event) {
      const file = event.target.files[0];
      
      if (file) {
        // Verificar si es una imagen
        if (!file.type.match('image.*')) {
          Swal.fire({
            title: "Error",
            text: "Por favor selecciona un archivo de imagen",
            icon: "error"
          });
          return;
        }

        // Mostrar vista previa
        const reader = new FileReader();
        
        reader.onload = function(e) {
          $previewImage
            .attr("src", e.target.result)
            .css("display", "block");
        };
        
        reader.onerror = function() {
          Swal.fire({
            title: "Error",
            text: "No se pudo leer el archivo",
            icon: "error"
          });
        };
        
        reader.readAsDataURL(file);
      }
    });

    // Manejar clic en el bot√≥n de subida
    $uploadButton.on("click", function() {
      $fileInput.click();
    });

    // Opcional: Mostrar nombre del archivo
    $fileInput.on("change", function() {
      const fileName = $(this).val().split("\\").pop();
      if (fileName) {
        $(this).siblings(".file-name").text(fileName);
      }
    });
  };

  // ======================================
  // INICIALIZAR COMPONENTE
  // ======================================
  initFileUpload();
});