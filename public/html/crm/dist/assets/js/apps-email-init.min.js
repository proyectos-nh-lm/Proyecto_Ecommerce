"use strict";

$(document).ready(function() {
  // Email search functionality
  $("#emailSearch").bind("keyup", function() {
    var searchText = $(this).val().toLowerCase();
    $(".single-items").filter(function() {
      $(this).toggle($(this).text().toLowerCase().indexOf(searchText) > -1);
    });
  });

  // Show/hide options based on checkbox
  $(document).on("change", "[data-checked-action='show-options']", function() {
    $(this).prop("checked") 
      ? $(".page-header-left").addClass("show-action")
      : $(".page-header-left").removeClass("show-action");
  });

  // Toggle details view
  $(document).on("click", "[data-view-toggle='details']", function() {
    $(".content-area").addClass("items-details-active");
  });

  // Close details view
  $(document).on("click", ".item-info-close", function() {
    $(".content-area").removeClass("items-details-active");
  });

  // Initialize Quill editors
  new Quill("#mailEditorModal", {
    placeholder: "Compose an epic...@mention, #tag",
    theme: "snow"
  });
  
  new Quill("#mailEditor", {
    placeholder: "Compose an epic...@mention, #tag",
    theme: "snow"
  });

  // Toggle CC/BCC fields
  $("#ccbccToggleModal").click(function(e) {
    e.preventDefault();
    $("#ccbccToggleModalFileds").toggle("1000");
  });
  
  $("#ccbccToggleContent").click(function(e) {
    e.preventDefault();
    $("#ccbccToggleContentFileds").toggle("1000");
  });

  // Mail action confirmation dialogs
  $('[data-action-target="#mailActionMessage"]').click(function(e) {
    e.preventDefault();
    const swal = Swal.mixin({
      customClass: {
        confirmButton: "btn btn-success m-1",
        cancelButton: "btn btn-danger m-1"
      },
      buttonsStyling: false
    });
    
    swal.fire({
      title: "Are you sure?",
      text: "You want to send this message!",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Yes, send it!",
      cancelButtonText: "No, cancel!",
      reverseButtons: true
    }).then((result) => {
      if (result.value) {
        swal.fire("Sent!", "Mail Sent Successfully.", "success");
      } else if (result.dismiss === Swal.DismissReason.cancel) {
        swal.fire("Cancelled", "Your imaginary file is safe :)", "error");
      }
    });
  });

  $('[data-action-target="#mailDeleteMessage"]').click(function(e) {
    e.preventDefault();
    const swal = Swal.mixin({
      customClass: {
        confirmButton: "btn btn-success m-1",
        cancelButton: "btn btn-danger m-1"
      },
      buttonsStyling: false
    });
    
    swal.fire({
      title: "Are you sure?",
      text: "You want to delete this message!",
      icon: "warning",
      showCancelButton: true,
      confirmButtonText: "Yes, delete it!",
      cancelButtonText: "No, cancel!",
      reverseButtons: true
    }).then((result) => {
      if (result.value) {
        swal.fire("Deleted!", "Mail Deleted Successfully.", "success");
      } else if (result.dismiss === Swal.DismissReason.cancel) {
        swal.fire("Cancelled", "Your imaginary file is safe :)", "error");
      }
    });
  });
});