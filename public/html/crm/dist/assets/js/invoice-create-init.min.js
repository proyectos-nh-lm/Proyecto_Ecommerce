"use strict";

$(document).ready(function() {
  // File Upload Functionality
  const initFileUpload = () => {
    $(".file-upload").on("change", function() {
      const fileInput = this;
      
      if (fileInput.files && fileInput.files[0]) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
          $(".upload-pic").attr("src", e.target.result);
        };
        
        reader.readAsDataURL(fileInput.files[0]);
      }
    });

    $(".upload-button").on("click", function() {
      $(".file-upload").click();
    });
  };

  // Date Picker Initialization
  const initDatePickers = () => {
    const issueDateInput = document.getElementById("issueDate");
    const dueDateInput = document.getElementById("dueDate");
    
    new Datepicker(issueDateInput, {
      clearBtn: true,
      allowOneSidedRange: true
    });
    
    new Datepicker(dueDateInput, {
      clearBtn: true,
      allowOneSidedRange: true
    });
  };

  // Input Formatting Initialization
  const initInputFormatters = () => {
    // Credit Card Input
    new Cleave(".input-credit-card", {
      creditCard: true,
      onCreditCardTypeChanged: function(type) {
        console.log(type);
        const typeElement = $(".input-credit-card-type").find(`.${type}`);
        
        if (typeElement.length) {
          typeElement.addClass("text-primary");
          typeElement.siblings().removeClass("text-primary");
        } else {
          $(".input-credit-card-type div").removeClass("text-primary");
        }
      }
    });

    // Date Format Input
    new Cleave(".input-date-formatting", {
      date: true,
      datePattern: ["m", "Y"]
    });

    // Block Format Input
    new Cleave(".input-Blocks-formatting", {
      blocks: [3]
    });
  };

  // Initialize all components
  initFileUpload();
  initDatePickers();
  initInputFormatters();
});